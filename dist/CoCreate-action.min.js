!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CoCreate=e():(t.CoCreate=t.CoCreate||{},t.CoCreate.action=e())}(this,(function(){return(()=>{"use strict";var t={};return(()=>{var e=t;e.default=void 0;const n={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const t=this;document.addEventListener("click",(function(e){let n=e.target;if(n.getAttribute("data-actions")||(n=e.target.closest("[data-actions]")),!n)return;e.preventDefault();let i=(n.getAttribute(t.attribute)||"").replace(/\s/g,"").split(",");0!=i.length&&(t.stageIndex=0,t.selectedStage=i,t.selectedElement=n,t.__runActionFunc())}))},init:function({action:t,callback:e,endEvent:n}){this.registerEvent(t,e,null,n)},registerEvent:function(t,e,n,i){if(this.actions[t])return;this.actions[t]={key:t,runFunc:e,instance:n||window,endEvent:i};for(let e in this.actions)if(e!=t&&this.actions[e].endEvent===i)return;const c=this;document.addEventListener(i,(function(t){c.__nextAction(i,t.detail)}))},__runActionFunc:function(t){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const e=this.selectedStage[this.stageIndex],n=this.actions[e];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,t):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(e,t)&&this.__moveNextAction()}},__nextAction:function(t,e){const n=this.selectedStage[this.stageIndex];n&&t===this.actions[n].endEvent&&this.__moveNextAction(e)},__runAtag:function(t){t.querySelector("a")},__runSpecialAction:function(t,e){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(t);if(!n||n.length<3)return"next";let i=n[1],c=n[2].trim();if(!c)return"next";const o=this;switch(i){case"event":document.addEventListener(c,(t=>{o.__moveNextAction(t)}),{once:!0});break;case"timeout":parseInt(c)>0&&setTimeout((function(){o.__moveNextAction(e)}),parseInt(c));break;case"action":let t=document.querySelector(c);t&&t.click();break;default:return"next"}},__moveNextAction:function(t){this.stageIndex++,this.__runActionFunc(t)}};n.__init();var i=n;e.default=i})(),t=t.default})()}));